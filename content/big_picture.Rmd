---
title: Big Picture
description:
toc: true
featuredImage: /images/The_Big_Picture_2.jpeg
featuredVideo:
draft: false
---

## Rubric: On this page

You will



* Title
  * Your big picture page should have a creative/click-baity title/headline that provides a hint about your thesis.
* Clarity of Explanation
  * You should have a clear thesis/goal for this page. What are you trying to show? Make sure that you explain your analysis in detail but don't go into top much mathematics or statistics. The audience for this page is the general public (to the extent possible).
* Quality of Figures
  * Each figure should be very polished and also not too complicated. There should be a clear interpretation of the figure so the figure has a clear purpose. Even something like a histogram can be difficult to interpret for non-experts.
* Creativity
  * Do your best to make things interesting. Think of a story. Think of how each part of your analysis supports the previous part or provides a different perspective.
  
**Note**: This page should have no code visible, i.e. use `echo=FALSE`.  

---

## Rubric: Other components

### Interactive

You will also be required to make an interactive dashboard like [this one](/flex/flex.html).

Your Big Data page should include a link to an interactive dashboard. The dashboard should be created either using Shiny or FlexDashboard (or another tool with professor's approval). This interactive component should in some way support your thesis from your big picture page. Good interactives often provide both high-level understanding of the data while allowing a user to investigate specific scenarios, observations, subgroups, etc.

* Quality and ease of use of the interactive components.
Is it clear what can be explored using your interactive components?
Does it enhance and reinforce your conclusions from the Big Picture?
Plotly with default hover text will get no credit. Be creative!


### Video Recording

Make a video recording (probably using Zoom) demonstrating your interactive components.
You should provide a quick explanation of your data and demonstrate some of the conclusions from your EDA.
This video should be no longer than 4 minutes.
Include a link to your video (and password if needed) in your README.md file on your Github repository. You are not required to provide a link on the website.
This can be presented by any subset of the team members.


### Rest of the Site

Finally, here are important things to keep in mind for the rest of the site. 

The main title of your page is informative.
Each post has an author/description/informative title.
All lab required posts are present.
Each page (including the home page) has a nice featured image associated with it.
Your about page is up to date and clean.
You have removed the generic posts from the initial site template.

## The Hot Hand. Just some Hot Air?: 

Oftentimes in sports, we say players are on “hot streaks” if they perform above a certain standard for multiple consecutive games. Some believe in the "hot hand", where a player is more likely to make his next shot based on his previous performance. Similarly, "the zone" refers to a player who is seemingly in another place mentally, scoring at an unusually high clip. Some brush the "hot hand" off as sports pseudoscience, looking at each shot or opportunity to score as an isolated event. But what are streaks exactly? Can we quantify them? Is there any truth to these phenomena? We aim to define the standard against which a streak can be determined, identify streaks based on this standard, and draw comparisons between streaks in two sports leagues in particular: the NBA and the MLB. 

## Between Two Sports:

One way we decided to assess the validity of streaks was by looking at two different sports. Basketball nd baseball are extremely different sports in many aspect, such as playstyle, team size, season length, game structure, offense and defense schemes, and much much more. This difference however may aid in determining sports. If we were to look at only one sport, and found that players really did get the hot hand, it may return a false-positive. We aim to see if the streakiness of players and teams are localized to their respective sports, or certain transcendental properties emerge between the two sports. Due to the differences in the leagues’ formats and the natures of each sport, we will perform our analyses with respect to each league and then comparatively analyze the leagues to draw conclusions on the nature and impact of streaks on the league, respectively. 

## What Will We Find? Who cares? :

We have defined streaks as a player performing above their average in a specific stat, or a combination of stats in a number of successive games. We suggest that not only is there a method to predict when these players get on “hot streaks,” but we can perform similar analyses across different sports, and even identify whether certain players are “streaky” in general. If you participate in fantasy sports leagues, our findings may help you get a leg up in your workplace league, anticipating breakout players or finding players that may give you that extra boost you need to finally beat Martha in accounting. If you place bets on games, our findings may help you break out of your slump... and get back the money you lost from betting on the Sacramento Kings to win it all. If you are simply interested in sports and want to have a new way to assess player output and find trends within our data, then our findings are for you. 



```{r app,echo=FALSE}
library(shiny)
library(tidyverse)
suppressPackageStartupMessages(library(here))
suppressPackageStartupMessages(library(modelr))

load(here::here("dataset-ignore", "clean_nba_data.RData"))
data <-data %>% mutate(PRA=pts+trb+ast) %>%mutate(usg_pct=usg_pct/100)
all_data <-data %>% group_by(player)  %>% filter(mean(minutes) >25,minutes >15) %>% mutate(change_net = pts - mean(pts),pts_direction  = 
                                                                                             sign(change_net),change_net_PRA=PRA - mean(PRA),PRA_direction=sign(change_net_PRA)) %>%mutate(pts_streak=ave(pts_direction, cumsum(pts_direction==-1), FUN = seq_along) - 1,PRA_streak=ave(PRA_direction, cumsum(PRA_direction==-1), FUN = seq_along) - 1)
all_data <-all_data %>%mutate(pts_direction=ifelse(pts_direction==-1,0,1))
players <- all_data %>% pull(player) %>% unique() %>% sort()

streak <-all_data$pts_streak
indices<-which(diff(sign(diff(streak)))==-2)+1
local_max <-slice(all_data,indices)
local_max<-local_max %>%group_by(player) %>% select(pts_streak,change_net,change_net_PRA,PRA_streak) %>%filter(pts_streak >0,PRA_streak >0)


player_data <-all_data %>% group_by(player) %>% mutate(a=10*lag(pts_direction)+pts_direction) %>% mutate(a=str_c(lag(pts_direction),pts_direction,sep = ',')) %>% count(a) %>% group_by(a)


# Define UI for application that plots a player's likelihood of scoring above their average
ui <- fluidPage(

    # Application title
    titlePanel("Analyzing Player Performance"),
    selectInput(inputId = "player", label = "player", choices = players),
    ##selectInput(inputId = "game_lag", label = "game_lag", choices = lags),
    plotOutput("linePlot"),
    plotOutput('spikePlot'),
    verbatimTextOutput("summary"),
    verbatimTextOutput('proportion')
        )

# Define server logic required to draw a histogram
server <- function(input, output) {
  
  mod1 <-reactive({
    all_data <-all_data %>% filter(player == input$player)
    mod1 <-all_data %>%ungroup() %>% glm(formula=factor(pts_direction)~off_rtg+usg_pct+usg_pct:off_rtg,family=binomial())
  })
  
  grid <- reactive({
    all_data <-all_data %>% filter(player == input$player)
    grid <- data_grid(ungroup(all_data),off_rtg=seq_range(off_rtg,100),usg_pct= seq_range(usg_pct,5)) %>% add_predictions(mod1(), type = "response" )
  })
  
  output$linePlot <- renderPlot({
      all_data <-all_data %>% filter(player == input$player) %>%select(usg_pct,off_rtg) %>% group_by(player)
      ggplot(all_data) +geom_line(aes(x=off_rtg,y=pred, color = factor(usg_pct)),data=grid())
    })
  
  output$spikePlot <-renderPlot({
    scoring <-all_data %>% filter(player == input$player,season == '2022') %>%select(change_net,game_date) %>% group_by(player)
    ggplot(scoring, aes(x=as.Date(as.factor(game_date)), y=change_net, group=1)) +
      geom_ribbon(aes(ymin=pmin(change_net,0), ymax=0), fill="red", col="red", alpha=0.5) +
      geom_ribbon(aes(ymin=0, ymax=pmax(change_net,0)), fill="green", col="green", alpha=0.5) +
      geom_point()+
      geom_line(aes(y=0)) + ggtitle('Change') +
      ylab('Points Deviated from Average') +
      xlab('Date')
    
  })
  
  output$summary <-renderPrint({
    local_max <-local_max %>% filter(player == input$player)
    pts <- all_data%>% filter(player == input$player) %>% select(pts) %>%summarize(pts=mean(pts))
    summary(local_max)
    pts
  })
  output$proportion <-renderPrint({
    player_data <-player_data %>% filter(player == input$player)
    player_data
  })
}

# Run the application 
shinyApp(ui = ui, server = server)
```
